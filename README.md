# vk_reg_bot
Бот ВКонтакте для регистрации на события с помощью QR-кода.

Использует API ВКонтакте для чат-ботов и pythonanywhere.com как облачный сервер.

---

## Описание работы
Бот был призван упростить процесс регистрации студентов на отработки по физической подготовке в МГТУ им. Баумана. В результате использования приложения время регистрации сократилось более чем в 20 раз.
Простые модификации кода позволят адаптировать бота под любые схожие задачи.

1. Администратор сообщества с помощью секретных команд (папка secret_commands) создает событие и открывает на него регистрацию.
2. Студенты в свою очередь регистрируются на событие и получают в ответном сообщении QR-код.
3. В назначенное время студенты приходят на событие и предъявляют организатору свой QR-код. То же самое они делают после окончания отработки. Процесс считывания QR-кода осуществляется любым мобильным приложением для этих целей.
4. Организатор отправляет боту csv-файл со списком QR-кодов
5. Студенты просматривают историю событий, расписание, и процесс начинается заново с пункта 1.

## Как запустить

0. Скопируйте репозиторий на сервер (рекомендуется pythonanywhere.com)
1. Выберите сообщество ВК, к чату с которым будет привязан бот.
2. Создайте ключ доступа (Callback API) в панели управления сообществом и установите соединение с сервером.
3. Создайте БД MySQL и сделайте таблицы (пример скрипта для создания таблиц в файле create_db.txt)
4. Создайте файл settings.py следующего вида: 
```
token = 'abcdefg****************************************************************************'
confirmation_token = '********'
admins = [1234****, 8765****] #id ВК администраторов
DB_params = {'host':"****.mysql.pythonanywhere-services.com", 'user':"****", 'passwd':"****", 'db':"****$****"} #впишите настройки соединения с БД
```
5. Перезагрузите сервер и поробуйте отправить сообщение сообществу

## Описание команд
### commands
| Команда | Файл | Описание |
| ------ | ------ | ------ |
| ПРИВЕТ | hello.py | Приветствие |
| ПОМОЩЬ | help.py | Справка по командам |
| РЕГИСТРАЦИЯ | register.py | Регистрация студента в боте |
| КАФЕДРА | department.py | Выбор кафеды |
| ГРУППА | group.py | Указание группы |
| ПРЕПОД | tutor.py | Указание преподавателя |
| ИНФО | info.py | Информация о студенте |
| РАСПИСАНИЕ | schedule.py | Расписание событий |
| ИДУ | train.py | Запись на отработку |
| ИСТОРИЯ | history.py | История посещений |

### secret_commands (для администраторов)
| Команда | Файл | Описание |
| ------ | ------ | ------ |
| ЗАНЯТИЕ | event.py | Добавить новое занятие |
| ОПИСАНИЕ | about.py | Добавить описание занятия |
| АКТИВ | activ.py | Открыть регистрацию на занятие |
| ДЕАКТИВ | deactiv.py | Закрыть регистрацию на занятие |
| СТАРТ | start.py | Добавить список стартовавших |
| ФИНИШ | finish.py | Добавить список финишировавших |
| ЭКСПОРТ | export.py | Получить список студентов |

### License
MIT

[//]: # (These are reference links used in the body of this note and get stripped out when the markdown processor does its job. There is no need to format nicely because it shouldn't be seen. Thanks SO - http://stackoverflow.com/questions/4823468/store-comments-in-markdown-syntax)
   [L4F]: <https://github.com/sankovalev/vk_reg_bot>
